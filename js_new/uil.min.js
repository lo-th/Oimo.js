'use strict';var UIL=UIL||function(){return{main:null,REVISION:"0.7",DEF:!1,SVG_TYPE:"rect circle path polygon text pattern defs g line foreignObject linearGradient stop animate radialGradient".split(" "),events:"onkeyup onkeydown onclick onchange onmouseover onmouseout onmousemove onmousedown onmouseup onmousewheel".split(" "),WIDTH:300,BW:190,AW:100,svgns:"http://www.w3.org/2000/svg",sizer:function(a){this.WIDTH=a.toFixed(0);a=this.WIDTH/3;this.BW=2*a-10;this.AW=a;this.main&&this.main.changeWidth()},
classDefine:function(){UIL.COLOR="N";UIL.SELECT="#035fcf";UIL.SELECTDOWN="#024699";UIL.SVGB="rgba(0,0,0,0.2)";UIL.SVGC="rgba(120,120,120,0.6)";UIL.txt1="font-family:Helvetica, Arial, sans-serif; font-size:12px; color:#cccccc; padding:0px 10px; left:0; top:3px; height:17px; width:100px; overflow:hidden;";UIL.CC("UIL","position:absolute; pointer-events:none; box-sizing:border-box; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none; margin:0; padding:0; ");
UIL.CC("UIL.content","width:300px; overflow:hidden; background:none;");UIL.CC("UIL.mask","width:400px; height:100%; margin-left:-50px; pointer-events:auto; cursor:col-resize; background:none; display:none;");UIL.CC("UIL.inner","width:300px; top:0; left:0; height:auto; overflow:hidden; background:none;");UIL.CC("UIL.base","position:relative; transition:height, 0.1s ease-out; height:20px; overflow:hidden;");UIL.CC("UIL.text",UIL.txt1);UIL.CC("input","border:solid 1px rgba(0,0,0,0.2); background:rgba(0,0,0,0.2); transition: 0.1s ease-out;",
!0);UIL.CC("input:focus","border: solid 1px rgba(0,0,0,0); background:rgba(0,0,0,0.6);",!0);UIL.CC("UIL.list","box-sizing:content-box; border:20px solid transparent; border-bottom:10px solid transparent; left:80px; top:0px; width:190px; height:90px; overflow:hidden; cursor:s-resize; pointer-events:auto; display:none;");UIL.CC("UIL.list-in","left:0; top:0; width:100%; background:rgba(0,0,0,0.2); ");UIL.CC("UIL.listItem","position:relative; height:18px; background:rgba(0,0,0,0.2); border-bottom:1px solid rgba(0,0,0,0.2); pointer-events:auto; cursor:pointer;"+
UIL.txt1);UIL.CC("UIL.listItem:hover","background:"+UIL.SELECT+"; color:#FFFFFF;");UIL.CC("UIL.scroll-bg","cursor:w-resize; pointer-events:auto; background:rgba(256,0,0,0.2);");UIL.CC("UIL.svgbox","left:100px; top:1px; width:190px; height:17px; pointer-events:auto; cursor:pointer; font-family:Helvetica, Arial, sans-serif; font-size:12px; text-align:center;");UIL.DEF=!0},bgcolor:function(a,b){var c=48,d=48,e=48;b=b||0.66;if(a)switch(a){case "r":case "R":case "S":c=160;e=68;break;case "g":case "G":case "E":d=
120;e=68;break;case "b":case "B":case "T":e=120;d=68;break;case "no":case "NO":b=0}c="rgba("+c+","+d+","+e+","+b+")";0==b&&(c="none");return c},setSVG:function(a,b,c,d){a.childNodes[d||0].setAttributeNS(null,b,c)},setDOM:function(a,b,c){a.style[b]=c+"px"},DOM:function(a,b,c,d,e){b=b||"div";if(-1!==this.SVG_TYPE.indexOf(b)){void 0==e&&(e=document.createElementNS(this.svgns,"svg"));b=document.createElementNS(this.svgns,b);b.setAttributeNS(null,"pointer-events","none");for(var f in d)"txt"==f?b.textContent=
d[f]:b.setAttributeNS(null,f,d[f]);e.appendChild(b);a&&e.setAttribute("class",a)}else void 0==e&&(e=document.createElement(b)),a&&(e.className=a);c&&(e.style.cssText=c);return e},CC:function(a,b,c){var d=".";c&&(d="");"*"==a&&(d="");c=document.createElement("style");c.type="text/css";document.getElementsByTagName("head")[0].appendChild(c);(c.sheet||{}).insertRule?c.sheet.insertRule(d+a+"{"+b+"}",0):(c.styleSheet||c.sheet).addRule(d+a,b)}}}();
UIL.Gui=function(a,b,c){UIL.sizer(b||300);UIL.main=this;this.isCenter=c||!1;this.lockwheel=!1;this.uis=[];this.content=UIL.DOM("UIL content","div",a);document.body.appendChild(this.content);this.top=parseFloat(this.content.style.top.substring(0,this.content.style.top.length-2));this.mask=UIL.DOM("UIL mask","div",a);document.body.appendChild(this.mask);this.inner=UIL.DOM("UIL inner");this.content.appendChild(this.inner);this.scrollBG=UIL.DOM("UIL scroll-bg","div","right:0; top:0; width:10px; height:100%; cursor:s-resize; display:none; background:none; ");
this.content.appendChild(this.scrollBG);this.scrollBG.name="move";this.scrollBG2=UIL.DOM("UIL scroll-bg","div","left:0; top:0; width:"+UIL.AW+"px; height:100%; cursor:s-resize; display:none; background:none;");this.content.appendChild(this.scrollBG2);this.scrollBG2.name="move";this.scroll=UIL.DOM(null,"rect","position:absolute; width:100%; height:100%; pointer-events:none;",{width:1,height:20,x:UIL.WIDTH-1,fill:"#666"});UIL.DOM(null,"rect","",{width:1,height:20,x:0,fill:"#666"},this.scroll);UIL.DOM(null,
"rect","",{width:300,height:1,x:0,fill:"#666"},this.scroll);this.content.appendChild(this.scroll);this.changeWidth();this.down=!1;this.f=[];this.f[0]=function(a){a.target.name&&"move"==a.target.name&&(this.down=!0,this.f[1](a),UIL.setSVG(this.scroll,"fill","#FFF"),UIL.setSVG(this.scroll,"fill","#FFF",1),UIL.setSVG(this.scroll,"fill","#FFF",2),a.preventDefault())}.bind(this);this.f[1]=function(a){if(this.down){var b=this.content.getBoundingClientRect();a=a.clientY-b.top-0.5*this.zone;0>a&&(a=0);a>
this.zone&&(a=this.zone);this.py=a/this.zone*this.range;this.f[5]()}}.bind(this);this.f[2]=function(a){this.down=!1;UIL.setSVG(this.scroll,"fill","#666");UIL.setSVG(this.scroll,"fill","#666",1);UIL.setSVG(this.scroll,"fill","#666",2)}.bind(this);this.f[3]=function(a){UIL.setSVG(this.scroll,"fill","#AAA");UIL.setSVG(this.scroll,"fill","#AAA",1);UIL.setSVG(this.scroll,"fill","#AAA",2)}.bind(this);this.f[4]=function(a){if(!this.lockwheel){var b=0;a.wheelDeltaY?b=0.04*-a.wheelDeltaY:a.wheelDelta?b=0.2*
-a.wheelDelta:a.detail&&(b=4*a.detail);this.py+=b;0>this.py&&(this.py=0);this.py>this.range&&(this.py=this.range);this.f[5]()}}.bind(this);this.f[5]=function(a){void 0!==a&&(this.py=a);this.inner.style.top=-this.py+"px";a=this.py*(this.height-this.sh)/this.range||0;UIL.setSVG(this.scroll,"y",a);UIL.setSVG(this.scroll,"y",a,1);0==this.py?UIL.setSVG(this.scroll,"y",0,2):this.py==this.max?UIL.setSVG(this.scroll,"y",this.height-1,2):UIL.setSVG(this.scroll,"y",-1,2)}.bind(this);this.content.onmousedown=
this.f[0];this.content.onmousemove=this.f[1];this.content.onmouseout=this.f[2];this.content.onmouseup=this.f[2];this.content.onmouseover=this.f[3];window.addEventListener("resize",function(a){this.resize(a)}.bind(this),!1);this.resize()};
UIL.Gui.prototype={constructor:UIL.Gui,show:function(){this.content.style.display="block"},hide:function(){this.content.style.display="none"},add:function(a,b){var c;switch(a){case "button":c=new UIL.Button(b);break;case "string":c=new UIL.String(b);break;case "number":c=new UIL.Number(b);break;case "title":c=new UIL.Title(b);break;case "color":c=new UIL.Color(b);break;case "slide":c=new UIL.Slide(b);break;case "bool":c=new UIL.Bool(b);break;case "list":c=new UIL.List(b);break;case "group":c=new UIL.Group(b)}this.uis.push(c);
this.calc();return c},resize:function(a){this.height=window.innerHeight-this.top-5;this.content.style.height=this.height+"px";this.zone=this.height-40;this.calc();this.f[5](0)},remove:function(a){a=this.uis.indexOf(a);-1!==a&&(this.uis[a].clear(),this.uis.splice(a,1))},clear:function(){this.f[5](0);for(var a=this.uis.length;a--;)this.uis[a].clear(),this.uis.pop();this.uis=[];this.calc()},showScroll:function(a){this.min=0;this.max=a-this.height;this.range=this.max-this.min;this.sh=this.height-40-100*
this.max/(this.height-40);20>this.sh&&(this.sh=20);UIL.setSVG(this.scroll,"height",this.sh);UIL.setSVG(this.scroll,"height",this.sh,1);this.scroll.style.display="block";this.scrollBG.style.display="block";this.scrollBG2.style.display="block";this.content.onmousewheel=this.f[4];this.f[5](0)},hideScroll:function(){this.f[5](0);this.scroll.style.display="none";this.scrollBG.style.display="none";this.scrollBG2.style.display="none";this.content.onmousewheel=null},calc:function(){for(var a=0,b=this.uis.length;b--;)a+=
this.uis[b].h;a>this.height?this.showScroll(a):this.hideScroll()},changeWidth:function(){UIL.setDOM(this.content,"width",UIL.WIDTH);var a=0;this.isCenter&&(a=0.5*-UIL.WIDTH,UIL.setDOM(this.content,"margin-left",a));UIL.setDOM(this.mask,"margin-left",a-50);UIL.setDOM(this.mask,"width",UIL.WIDTH+100);UIL.setDOM(this.inner,"width",UIL.WIDTH);UIL.setSVG(this.scroll,"x",UIL.WIDTH-1,0);UIL.setSVG(this.scroll,"width",UIL.WIDTH,2);for(a=this.uis.length;a--;)this.uis[a].setSize(),this.uis[a].rSize()},liner:function(a){return UIL.DOM("UIL",
"line","width:100%; height:1px; bottom:0px;",{x1:0,y1:0,x2:"100%",y2:0,stroke:a||"rgba(0,0,0,0.5)","stroke-width":1,"stroke-linecap":"butt"})}};UIL.classDefine();UIL.Proto=function(a){a=a||{};this.mono=!1;this.simple=a.simple||!1;this.liner=null;this.setSize(a.size);this.h=20;a.color&&(UIL.COLOR=a.color);this.color=UIL.COLOR;this.txt=a.name||"Proto";this.target=a.target||null;this.callback=a.callback||function(){};this.c=[];this.f=[];this.c[0]=UIL.DOM("UIL base");this.c[1]=UIL.DOM("UIL text");this.simple||(this.c[1].textContent=this.txt);if(a.pos){this.c[0].style.position="absolute";for(var b in a.pos)this.c[0].style[b]=a.pos[b];this.mono=!0}else UIL.main&&
(this.liner=UIL.main.liner(),this.c[0].appendChild(this.liner))};
UIL.Proto.prototype={constructor:UIL.Proto,init:function(){this.c[0].style.background=UIL.bgcolor(this.color);for(var a=0;a<this.c.length;a++)0==a?null!==this.target?this.target.appendChild(this.c[0]):UIL.main.inner.appendChild(this.c[0]):this.c[0].appendChild(this.c[a]);this.rSize()},setCallBack:function(a){this.callback&&(this.callback=null);this.callback=a},setSize:function(a){this.size=a||UIL.WIDTH;this.simple?(this.sa=1,this.sb=a-2):(this.sa=1*(this.size/3).toFixed(0),this.sb=1*(2*this.sa-10).toFixed(0))},
setDom:function(a,b,c){this.c[a].style[b]=c+"px"},setSvg:function(a,b,c,d){this.c[a].childNodes[d||0].setAttributeNS(null,b,c)},clear:function(){for(var a=UIL.events,b=this.c.length,c;b--;){if(0==b)null!==this.liner&&(this.c[0].removeChild(this.liner),this.liner=null),null!==this.target?this.target.removeChild(this.c[0]):UIL.main.inner.removeChild(this.c[0]);else{for(c=a.length;c--;)null!==this.c[b][a[c]]&&(this.c[b][a[c]]=null);this.c[b].children&&this.clearDOM(this.c[b]);this.c[0].removeChild(this.c[b])}this.c[b]=
null}this.c=null;if(this.f){for(b=this.f.length;b--;)this.f[b]=null;this.f=null}this.callback&&(this.callback=null);this.value&&(this.value=null)},clearDOM:function(a){for(;a.children.length;){if(a.lastChild.children)for(;a.lastChild.children.length;)a.lastChild.removeChild(a.lastChild.lastChild);a.removeChild(a.lastChild)}},setTypeNumber:function(a){this.min=-Infinity;this.max=Infinity;this.precision=2;void 0!==a.precision&&(this.precision=a.precision);this.step=0.01;switch(this.precision){case 0:this.step=
1;break;case 1:this.step=0.1;break;case 2:this.step=0.01;break;case 3:this.step=0.001;break;case 4:this.step=1E-4}void 0!==a.min&&(this.min=a.min);void 0!==a.max&&(this.max=a.max);void 0!==a.step&&(this.step=a.step)},numValue:function(a){return 1*Math.min(this.max,Math.max(this.min,a)).toFixed(this.precision)},rSize:function(){this.c[0].style.width=this.size+"px";this.simple||(this.c[1].style.width=this.sa+"px")}};UIL.Group=function(a){UIL.Proto.call(this,a);this.h=25;this.isOpen=!1;this.c[2]=UIL.DOM("UIL","div","top:25px; overflow:hidden;");this.c[3]=UIL.DOM("UIL","path","position:absolute; width:16px; left:"+(this.sa+this.sb-17)+"px; top:4px; pointer-events:none;",{width:16,height:16,d:"M 6 4 L 10 8 6 12","stroke-width":2,stroke:"#e2e2e2",fill:"none","stroke-linecap":"butt"});this.setDom(0,"height",this.h);this.setDom(1,"height",this.h);this.setDom(1,"top",0);this.c[1].style.pointerEvents="auto";this.c[1].style.cursor=
"pointer";this.c[1].name="group";this.setDom(1,"top",4);this.uis=[];this.f[0]=function(){this.isOpen?this.close():this.open();UIL.main.calc()}.bind(this);this.c[1].onclick=this.f[0];this.init()};UIL.Group.prototype=Object.create(UIL.Proto.prototype);UIL.Group.prototype.constructor=UIL.Group;
UIL.Group.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.setDom(3,"left",this.sa+this.sb-17);this.setDom(1,"width",this.size);this.setDom(2,"width",this.size);for(var a=this.uis.length;a--;)this.uis[a].setSize(),this.uis[a].rSize();this.calc()};UIL.Group.prototype.add=function(a,b){b.target=this.c[2];UIL.Gui.prototype.add.call(this,a,b)};
UIL.Group.prototype.calc=function(){if(this.isOpen){this.h=25;for(var a=this.uis.length;a--;)this.h+=this.uis[a].h;this.setDom(2,"height",this.h-25);this.setDom(0,"height",this.h)}};UIL.Group.prototype.open=function(){this.isOpen=!0;this.setSvg(3,"d","M 12 6 L 8 10 4 6");this.calc()};UIL.Group.prototype.close=function(){this.isOpen=!1;this.setSvg(3,"d","M 6 4 L 10 8 6 12");this.h=25;this.setDom(2,"height",0);this.setDom(0,"height",this.h)};UIL.Group.prototype.clear=function(){this.clearGroup();UIL.Proto.prototype.clear.call(this)};
UIL.Group.prototype.clearGroup=function(){for(var a=this.uis.length;a--;)this.uis[a].clear(),this.uis.pop();this.uis=[];this.calc()};UIL.Title=function(a){UIL.Proto.call(this,a);this.h=a.height||31;var b=a.id||0;a=a.prefix||"";this.c[2]=UIL.DOM("UIL text","div","text-align:right; width:40px; padding:0px 5px;");31==this.h&&(this.setDom(0,"height",this.h),this.setDom(1,"top",8),this.setDom(2,"top",8));var c=b||0;10>b&&(c="0"+b);this.c[1].textContent=this.txt.substring(0,1).toUpperCase()+this.txt.substring(1).replace("-"," ");this.c[2].textContent=a.toUpperCase()+" "+c;this.init()};UIL.Title.prototype=Object.create(UIL.Proto.prototype);
UIL.Title.prototype.constructor=UIL.Title;UIL.Title.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.setDom(1,"width",this.size-50);this.setDom(2,"left",this.size-76)};UIL.Title.prototype.text=function(a){this.c[1].textContent=a};UIL.Title.prototype.text2=function(a){this.c[2].textContent=a};UIL.String=function(a){UIL.Proto.call(this,a);this.value=a.value||"";this.allway=a.allway||!1;this.c[2]=UIL.DOM("UIL text","input","pointer-events:auto; padding:0px 5px; padding-bottom:2px;");this.c[2].name="input";this.f[0]=function(a){13===a.keyCode&&(this.callback(a.target.value),a.target.blur());a.stopPropagation()}.bind(this);this.f[1]=function(a){this.allway&&this.callback(a.target.value);a.stopPropagation()}.bind(this);this.c[2].value=this.value;this.c[2].onkeydown=this.f[0];this.c[2].onkeyup=
this.f[1];this.init()};UIL.String.prototype=Object.create(UIL.Proto.prototype);UIL.String.prototype.constructor=UIL.String;UIL.String.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.setDom(2,"width",this.sb);this.setDom(2,"left",this.sa)};UIL.Number=function(a){UIL.Proto.call(this,a);this.setTypeNumber(a);this.value=[0];this.toRad=1;this.isNumber=!0;this.isVector=this.isAngle=!1;this.mask=this.mono?null:UIL.main.mask;a.value&&(isNaN(a.value)?a.value instanceof Array?(this.value=a.value,this.isNumber=!1):a.value instanceof Object&&(this.value=[],a.value.x&&(this.value[0]=a.value.x),a.value.y&&(this.value[1]=a.value.y),a.value.z&&(this.value[2]=a.value.z),a.value.w&&(this.value[3]=a.value.w),this.isVector=!0):this.value=[a.value]);this.length=
this.value.length;a.isAngle&&(this.isAngle=!0,this.toRad=Math.PI/180);this.w=(UIL.BW+5)/this.length-5;this.current=null;for(a=this.length;a--;)this.isAngle&&(this.value[a]=(180*this.value[a]/Math.PI).toFixed(this.precision)),this.c[2+a]=UIL.DOM("UIL text","input","pointer-events:auto; padding:0px 5px; padding-bottom:2px; width:"+this.w+"px; left:"+(UIL.AW+this.w*a+5*a)+"px;"),this.c[2+a].name=a,this.c[2+a].value=this.value[a];null==this.mask&&(this.c[2+this.length]=UIL.DOM("UIL mask","div"),this.mask=
this.c[2+this.length]);this.f[0]=function(a){a||(a=window.event);13===a.keyCode&&(this.current=parseFloat(a.target.name),this.f[4](this.current),this.f[5](),a.target.blur())}.bind(this);this.f[1]=function(a){this.current=parseFloat(a.target.name);void 0!=this.current&&(a.preventDefault(),this.prev={x:a.clientX,y:a.clientY,d:0,id:this.current+2},this.prev.v=this.isNumber?parseFloat(this.value):parseFloat(this.value[this.current]),this.mask.style.display="block",this.mask.onmousemove=this.f[2],this.mask.onmouseup=
this.f[3],this.mask.onmouseout=this.f[3])}.bind(this);this.f[2]=function(a){this.prev.d+=a.clientX-this.prev.x-(a.clientY-this.prev.y);this.value[this.current]=this.numValue(this.prev.v+this.prev.d*this.step);this.c[this.prev.id].value=this.value[this.current];this.f[5]();this.prev.x=a.clientX;this.prev.y=a.clientY}.bind(this);this.f[3]=function(a){this.mask.style.display="none";this.mask.onmousemove=null;this.mask.onmouseup=null;this.mask.onmouseout=null;2>Math.abs(this.prev.d)&&(this.c[this.prev.id].focus(),
this.c[this.prev.id].select())}.bind(this);this.f[4]=function(a){isNaN(this.c[2+a].value)?this.c[2+a].value=this.value[a]:this.value[a]=this.c[2+a].value}.bind(this);this.f[5]=function(){for(var a=[],c=this.length;c--;)a[c]=this.value[c]*this.toRad;this.isNumber?this.callback(a[0]):this.callback(a)}.bind(this);for(a=0;a<this.length;a++)this.c[2+a].onkeydown=this.f[0],this.c[2+a].onmousedown=this.f[1];this.init()};UIL.Number.prototype=Object.create(UIL.Proto.prototype);
UIL.Number.prototype.constructor=UIL.Number;UIL.Number.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.w=(this.sb+5)/this.length-5;for(var a=this.length;a--;)this.setDom(2+a,"left",this.sa+this.w*a+5*a),this.setDom(2+a,"width",this.w)};UIL.Color=function(a){UIL.Proto.call(this,a);this.type=a.type||"array";this.width=this.sb;this.oldWidth=0;this.side=a.side||"down";this.holdTop=0;this.wheelWidth=0.1*this.width;this.decal=22;this.radius=0.5*(this.width-this.wheelWidth)-1;this.square=Math.floor(0.7*(this.radius-0.5*this.wheelWidth))-1;this.mid=Math.floor(0.5*this.width);this.markerSize=0.3*this.wheelWidth;this.c[2]=UIL.DOM("UIL svgbox","rect","",{width:this.sb,height:17,fill:"#000","stroke-width":1,stroke:UIL.SVGC});this.c[3]=UIL.DOM("UIL text");
"up"==this.side&&(this.decal=5,this.c[3].style.top="auto",this.c[2].style.top="auto",this.c[3].style.bottom="2px",this.c[2].style.bottom="2px");this.c[4]=UIL.DOM("UIL","rect","left:"+this.sa+"px;  top:"+this.decal+"px; width:"+this.width+"px; height:"+this.width+"px;",{x:this.mid-this.square,y:this.mid-this.square,width:2*this.square-1,height:2*this.square-1,fill:"#000"});this.c[5]=UIL.DOM("UIL","canvas","left:"+this.sa+"px;  top:"+this.decal+"px; display:none;");this.c[6]=UIL.DOM("UIL","canvas",
"left:"+this.sa+"px;  top:"+this.decal+"px; pointer-events:auto; cursor:pointer; display:none;");"up"==this.side&&(this.c[6].style.pointerEvents="none");this.c[5].width=this.c[5].height=this.width;this.c[6].width=this.c[6].height=this.width;this.ctxMask=this.c[5].getContext("2d");this.ctxOverlay=this.c[6].getContext("2d");this.ctxMask.translate(this.mid,this.mid);this.ctxOverlay.translate(this.mid,this.mid);this.hsl=null;this.value="#ffffff";a.value&&(a.value instanceof Array?this.value=UIL.pack(a.value):
isNaN(a.value)?this.value=a.value:this.value=UIL.numFormat(a.value));this.bcolor=null;this.isShow=this.down=!1;this.f[0]=function(a){this.isShow?this.hide():this.show()}.bind(this);this.f[1]=function(a){this.down||(this.down=!0,this.c[6].onmousemove=this.f[2],this.c[6].onmouseup=this.f[3]);this.offset=this.c[6].getBoundingClientRect();var c=this.widgetCoords(a);this.circleDrag=Math.max(Math.abs(c.x),Math.abs(c.y))>this.square+2;this.f[2](a);return!1}.bind(this);this.f[2]=function(a){var c=this.widgetCoords(a);
this.circleDrag?(a=Math.atan2(c.x,-c.y)/6.28,this.setHSL([(a+1)%1,this.hsl[1],this.hsl[2]])):(a=Math.max(0,Math.min(1,-(c.x/this.square*0.5)+0.5)),c=Math.max(0,Math.min(1,-(c.y/this.square*0.5)+0.5)),this.setHSL([this.hsl[0],a,c]));return!1}.bind(this);this.f[3]=function(a){this.c[6].onmouseup=null;this.c[6].onmousemove=null;this.down=!1}.bind(this);this.c[2].onclick=this.f[0];this.setColor(this.value);this.init()};UIL.Color.prototype=Object.create(UIL.Proto.prototype);
UIL.Color.prototype.constructor=UIL.Color;UIL.Color.prototype.redraw=function(){this.oldWidth=this.width;this.drawCircle();this.drawMask();this.drawMarkers()};
UIL.Color.prototype.show=function(){this.oldWidth!==this.width&&this.redraw();this.isShow=!0;this.h=this.width+30;this.c[0].style.height=this.h+"px";"up"==this.side&&(this.holdTop=1*this.c[0].style.top.substring(0,this.c[0].style.top.length-2)||"auto",isNaN(this.holdTop)||(this.c[0].style.top=this.holdTop-(this.h-20)+"px"),setTimeout(function(){this.c[6].style.pointerEvents="auto"}.bind(this),100));this.c[4].style.display="block";this.c[5].style.display="block";this.c[6].style.display="block";this.c[6].onmousedown=
this.f[1];this.c[6].onmouseout=function(){this.hide()}.bind(this);UIL.main&&UIL.main.calc()};UIL.Color.prototype.hide=function(){this.isShow=!1;this.h=20;"up"==this.side&&(isNaN(this.holdTop)||(this.c[0].style.top=this.holdTop+"px"),this.c[6].style.pointerEvents="none");this.c[0].style.height=this.h+"px";this.c[4].style.display="none";this.c[5].style.display="none";this.c[6].style.display="none";this.c[6].onmousedown=null;this.c[6].onmouseout=null;UIL.main&&UIL.main.calc()};
UIL.Color.prototype.updateDisplay=function(){this.invert=0.6>=0.3*this.rgb[0]+0.59*this.rgb[1]+0.11*this.rgb[2];this.setSvg(4,"fill",UIL.pack(UIL.HSLToRGB([this.hsl[0],1,0.5])));this.drawMarkers();this.value=this.bcolor;this.setSvg(2,"fill",this.bcolor);this.c[3].textContent=UIL.hexFormat(this.bcolor);this.c[3].style.color=this.invert?"#fff":"#000";"array"==this.type&&this.callback(this.rgb);"html"==this.type&&this.callback(this.value);"hex"==this.type&&this.callback(this.value)};
UIL.Color.prototype.setColor=function(a){var b=UIL.unpack(a);this.bcolor!=a&&b&&(this.bcolor=a,this.rgb=b,this.hsl=UIL.RGBtoHSL(this.rgb),this.updateDisplay());return this};UIL.Color.prototype.setHSL=function(a){this.hsl=a;this.rgb=UIL.HSLToRGB(a);this.bcolor=UIL.pack(this.rgb);this.updateDisplay();return this};UIL.Color.prototype.calculateMask=function(a,b,c){for(var d=1/a,e=1/b,f=0;f<=b;++f)for(var g=1-f*e,h=0;h<=a;++h){var k=1-h*d,k=1-2*Math.min(g*k,(1-g)*k);c(h,f,0<k?0.5*(2*g-1+k)/k:0,k)}};
UIL.Color.prototype.drawMask=function(){var a=this.square,b=Math.floor(2*this.square/2),c=document.createElement("canvas");c.width=c.height=b+1;var d=c.getContext("2d"),e=d.getImageData(0,0,b+1,b+1),f=0;this.calculateMask(b,b,function(a,b,c,d){e.data[f++]=e.data[f++]=e.data[f++]=255*c;e.data[f++]=255*d});d.putImageData(e,0,0);this.ctxMask.drawImage(c,0,0,b+1,b+1,-a,-a,2*a,2*a)};
UIL.Color.prototype.drawCircle=function(){var a=this.radius,b=this.wheelWidth,c=8/a/24*Math.PI,d=this.ctxMask,e=0,f,g,h,k;d.save();d.lineWidth=b/a;d.scale(a,a);for(var l=0;24>=l;++l)k=l/24,a=k*Math.PI*2,b=[Math.sin(e),-Math.cos(e),Math.sin(a),-Math.cos(a)],g=0.5*(e+a),h=1/Math.cos(0.5*(a-e)),e=Math.sin(g)*h,g=-Math.cos(g)*h,k=UIL.pack(UIL.HSLToRGB([k,1,0.5])),0<l&&(h=d.createLinearGradient(b[0],b[1],b[2],b[3]),h.addColorStop(0,f),h.addColorStop(1,k),d.strokeStyle=h,d.beginPath(),d.moveTo(b[0],b[1]),
d.quadraticCurveTo(e,g,b[2],b[3]),d.stroke()),e=a-c,f=k;d.restore()};
UIL.Color.prototype.drawMarkers=function(){var a=this.markerSize,b=this.radius,c=this.width,d=Math.ceil(a/4),e=a-d+1,f=this.invert?"#fff":"#000",g=this.invert?"#000":"#fff",h=6.28*this.hsl[0],b=[Math.sin(h)*b,-Math.cos(h)*b,2*this.square*(0.5-this.hsl[1]),2*this.square*(0.5-this.hsl[2])],a=[{x:b[2],y:b[3],r:a,c:f,lw:d},{x:b[2],y:b[3],r:e,c:g,lw:d+1},{x:b[0],y:b[1],r:a,c:"#fff",lw:d},{x:b[0],y:b[1],r:e,c:"#000",lw:d+1}];this.ctxOverlay.clearRect(-this.mid,-this.mid,c,c);for(c=a.length;c--;)d=a[c],
this.ctxOverlay.lineWidth=d.lw,this.ctxOverlay.strokeStyle=d.c,this.ctxOverlay.beginPath(),this.ctxOverlay.arc(d.x,d.y,d.r,0,2*Math.PI,!0),this.ctxOverlay.stroke()};UIL.Color.prototype.widgetCoords=function(a){return{x:a.pageX-this.offset.left-this.mid,y:a.pageY-this.offset.top-this.mid}};
UIL.Color.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.width=this.sb;this.wheelWidth=0.1*this.width;this.decal=22;"up"==this.side&&(this.decal=5);this.radius=0.5*(this.width-this.wheelWidth)-1;this.square=Math.floor(0.7*(this.radius-0.5*this.wheelWidth))-1;this.mid=Math.floor(0.5*this.width);this.markerSize=0.3*this.wheelWidth;this.setSvg(2,"width",this.sb);this.setDom(2,"width",this.sb);this.setDom(2,"left",this.sa);this.setDom(3,"width",this.sb);this.setDom(3,"left",this.sa);
this.setDom(4,"left",this.sa);this.setDom(4,"width",this.width);this.setDom(4,"height",this.width);this.setDom(5,"left",this.sa);this.setDom(6,"left",this.sa);this.setSvg(4,"width",2*this.square-1);this.setSvg(4,"height",2*this.square-1);this.setSvg(4,"x",this.mid-this.square);this.setSvg(4,"y",this.mid-this.square);this.c[5].width=this.c[5].height=this.width;this.c[6].width=this.c[6].height=this.width;this.c[5].style.left=this.sa+"px";this.c[6].style.left=this.sa+"px";this.c[5].style.top=this.decal+
"px";this.c[6].style.top=this.decal+"px";this.ctxMask.translate(this.mid,this.mid);this.ctxOverlay.translate(this.mid,this.mid);this.isShow&&(this.redraw(),this.h=this.width+30,this.setDom(0,"height",this.h),UIL.main&&UIL.main.calc())};UIL.hexToHtml=function(a){return"#"+("000000"+a.toString(16)).substr(-6)};UIL.numFormat=function(a){return"#"+("000000"+a.toString(16)).substr(-6)};UIL.hexFormat=function(a){return a.toUpperCase().replace("#","0x")};
UIL.pack=function(a){var b=Math.round(255*a[0]),c=Math.round(255*a[1]);a=Math.round(255*a[2]);return"#"+UIL.dec2hex(b)+UIL.dec2hex(c)+UIL.dec2hex(a)};UIL.u255=function(a,b){return parseInt(a.substring(b,b+2),16)/255};UIL.u16=function(a,b){return parseInt(a.substring(b,b+1),16)/15};UIL.unpack=function(a){if(7==a.length)return[UIL.u255(a,1),UIL.u255(a,3),UIL.u255(a,5)];if(4==a.length)return[UIL.u16(a,1),UIL.u16(a,2),UIL.u16(a,3)]};
UIL.packDX=function(a,b){return"#"+UIL.dec2hex(b)+UIL.dec2hex(a)+UIL.dec2hex(a)+UIL.dec2hex(a)};UIL.dec2hex=function(a){return(16>a?"0":"")+a.toString(16)};UIL.HSLToRGB=function(a){var b,c=a[0];b=a[1];a=a[2];b=0.5>=a?a*(b+1):a+b-a*b;a=2*a-b;return[UIL.HUEtoRGB(a,b,c+0.33333),UIL.HUEtoRGB(a,b,c),UIL.HUEtoRGB(a,b,c-0.33333)]};UIL.HUEtoRGB=function(a,b,c){c=(c+1)%1;return 1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(0.66666-c)*6:a};
UIL.RGBtoHSL=function(a){var b=a[0],c=a[1];a=a[2];var d=Math.min(b,c,a),e=Math.max(b,c,a),f=e-d,g=0,h=0,d=(d+e)/2;0<d&&1>d&&(h=f/(0.5>d?2*d:2-2*d));0<f&&(e==b&&e!=c&&(g+=(c-a)/f),e==c&&e!=a&&(g+=2+(a-b)/f),e==a&&e!=b&&(g+=4+(b-c)/f),g/=6);return[g,h,d]};UIL.Slide=function(a){UIL.Proto.call(this,a);this.setTypeNumber(a);this.range=this.max-this.min;this.width=UIL.BW-40;this.w=this.width-8;this.height=17;this.value=a.value||0;this.down=!1;this.c[2]=UIL.DOM("UIL text","div","text-align:right; width:40px; padding:0px 5px;");this.c[3]=UIL.DOM("UIL svgbox","rect","width:"+this.width+"px; height:"+this.height+"px; cursor:w-resize;",{width:this.width,height:this.height,fill:UIL.SVGB,"stroke-width":1,stroke:UIL.SVGC});this.c[4]=UIL.DOM("UIL svgbox","rect",
"width:"+this.width+"px; height:"+this.height+"px; pointer-events:none;",{x:4,y:4,width:this.width-8,height:this.height-8,fill:"#CCC","stroke-width":1,stroke:UIL.SVGC});this.f[0]=function(a){this.setSvg(3,"fill","rgba(0,0,0,0.6)");this.setSvg(4,"fill",UIL.SELECT)}.bind(this);this.f[1]=function(a){this.down=!1;this.setSvg(3,"fill","rgba(0,0,0,0.2)");this.setSvg(4,"fill","#CCC")}.bind(this);this.f[2]=function(a){this.down=!1}.bind(this);this.f[3]=function(a){this.down=!0;this.prev={x:a.clientX,d:0,
v:parseFloat(this.value)};this.f[4](a)}.bind(this);this.f[4]=function(a){if(this.down){a.preventDefault();var c=this.c[3].getBoundingClientRect();a=(a.clientX-c.left-4)/this.w*this.range+this.min-this.prev.v;if(a>this.step||a<this.step)a=1*(a/this.step).toFixed(0),this.value=this.numValue(this.prev.v+a*this.step),this.f[5](!0),this.prev.v=this.value}}.bind(this);this.f[5]=function(a){this.setSvg(4,"width",(this.value-this.min)/this.range*this.w);this.c[2].innerHTML=this.value;a&&this.callback(this.value)}.bind(this);
this.c[3].onmouseover=this.f[0];this.c[3].onmouseout=this.f[1];this.c[3].onmouseup=this.f[2];this.c[3].onmousedown=this.f[3];this.c[3].onmousemove=this.f[4];this.f[5](!1);this.init()};UIL.Slide.prototype=Object.create(UIL.Proto.prototype);UIL.Slide.prototype.constructor=UIL.Slide;
UIL.Slide.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.width=this.sb-40;this.w=this.width-8;this.setDom(2,"left",this.size-50);this.setSvg(3,"width",this.width);this.setDom(3,"left",this.sa);this.setDom(3,"width",this.width);this.setDom(4,"left",this.sa);this.setDom(4,"width",this.width);this.f[5](!1)};UIL.List=function(a){UIL.Proto.call(this,a);this.c[2]=UIL.DOM("UIL list");this.c[3]=UIL.DOM("UIL svgbox","rect","",{width:this.sb,height:17,fill:UIL.bgcolor(UIL.COLOR),"stroke-width":1,stroke:UIL.SVGC});this.c[4]=UIL.DOM("UIL","path","position:absolute; width:16px; height:16px; left:"+(this.sa+this.sb-17)+"px; top:1px; pointer-events:none;",{width:16,height:16,d:"M 6 4 L 10 8 6 12","stroke-width":2,stroke:"#e2e2e2",fill:"none","stroke-linecap":"butt"});this.c[5]=UIL.DOM("UIL text","div","text-align:center;");
this.c[6]=UIL.DOM("UIL svgbox","rect","top:20px; height:90px; pointer-events:none;",{x:this.sb-15,y:0,width:10,height:16,fill:"#666","stroke-width":1,stroke:UIL.SVGC});this.list=a.list||[];a.value?isNaN(a.value)?this.value=a.value:this.value=this.list[a.value]:this.value=this.list[0];this.show=!1;this.maxItem=a.maxItem||5;this.length=this.list.length;if(this.full=a.full||!1)this.maxItem=this.length;this.maxHeight=18*this.maxItem;this.max=18*this.length;this.w=this.sb;this.down=!1;this.range=this.max-
this.maxHeight;this.py=0;this.scroll=!1;this.side=a.side||"down";this.holdTop=0;"up"==this.side&&(this.c[2].style.top="auto",this.c[3].style.top="auto",this.c[4].style.top="auto",this.c[5].style.top="auto",this.c[2].style.bottom="10px",this.c[3].style.bottom="2px",this.c[4].style.bottom="2px",this.c[5].style.bottom="2px");this.max>this.maxHeight&&(this.w=this.sb-20,this.scroll=!0);this.listIn=UIL.DOM("UIL list-in");this.listIn.name="list";this.c[2].style.height=this.maxHeight+"px";this.c[2].appendChild(this.listIn);
for(var b,c=0;c<this.length;c++)b=this.list[c],a=UIL.DOM("UIL listItem","div","width:"+this.w+"px; height:18px;"),a.textContent=b,a.name=b,this.listIn.appendChild(a);this.c[5].textContent=this.value;this.c[2].name="list";this.f[0]=function(a){if(this.show)this.f[1]();else this.f[2]()}.bind(this);this.f[1]=function(a){this.show=!1;this.h=20;this.c[0].style.height=this.h+"px";this.c[2].style.display="none";this.setSvg(4,"d","M 6 4 L 10 8 6 12");UIL.main&&UIL.main.calc()}.bind(this);this.f[2]=function(a){this.f[8](0);
this.show=!0;this.h=this.maxHeight+30;this.scroll||(this.h=30+this.max,this.c[6].style.display="none",this.c[2].onmousemove=null,this.c[2].onmousewheel=null);this.c[0].style.height=this.h+"px";this.c[2].style.display="block";"up"==this.side?this.setSvg(4,"d","M 12 10 L 8 6 4 10"):this.setSvg(4,"d","M 12 6 L 8 10 4 6");UIL.main&&UIL.main.calc()}.bind(this);this.f[3]=function(a){var b=a.target.name;"list"!==b&&void 0!==b?(this.value=a.target.name,this.c[5].textContent=this.value,this.callback(this.value),
this.f[1]()):"list"==b&&this.scroll&&(this.down=!0,this.f[4](a),this.listIn.style.background="rgba(0,0,0,0.6)",this.setSvg(6,"fill","#AAA"),a.preventDefault())}.bind(this);this.f[4]=function(a){if(this.down){var b=this.c[2].getBoundingClientRect();a=a.clientY-b.top;30>a&&(a=30);100<a&&(a=100);this.py=((a-30)/70*this.range).toFixed(0);this.f[8]()}}.bind(this);this.f[5]=function(a){UIL.main&&(UIL.main.lockwheel=!1);this.f[6]();if(void 0==a.relatedTarget.name)this.f[1]()}.bind(this);this.f[6]=function(a){this.down=
!1;this.listIn.style.background="rgba(0,0,0,0.2)";this.setSvg(6,"fill","#666")}.bind(this);this.f[7]=function(a){if(this.scroll){UIL.main&&(UIL.main.lockwheel=!0);var b=0;a.wheelDeltaY?b=0.04*-a.wheelDeltaY:a.wheelDelta?b=0.2*-a.wheelDelta:a.detail&&(b=4*a.detail);this.py+=b;0>this.py&&(this.py=0);this.py>this.range&&(this.py=this.range);this.f[8]()}}.bind(this);this.f[8]=function(a){this.scroll&&(void 0!==a&&(this.py=a),this.listIn.style.top=-this.py+"px",this.setSvg(6,"y",70*this.py/this.range+
2))}.bind(this);this.f[9]=function(a){this.c[5].style.color="#FFF";this.setSvg(3,"fill",UIL.SELECT)}.bind(this);this.f[10]=function(a){this.c[5].style.color="#CCC";this.setSvg(3,"fill",UIL.bgcolor(UIL.COLOR))}.bind(this);this.f[11]=function(a){this.c[5].style.color="#CCC";this.setSvg(3,"fill",UIL.SELECTDOWN)}.bind(this);this.c[2].onmousedown=this.f[3];this.c[2].onmousemove=this.f[4];this.c[2].onmouseout=this.f[5];this.c[2].onmouseup=this.f[6];this.c[2].onmousewheel=this.f[7];this.c[3].onclick=this.f[0];
this.c[3].onmouseover=this.f[9];this.c[3].onmouseout=this.f[10];this.c[3].onmouseup=this.f[10];this.c[3].onmousedown=this.f[11];this.init()};UIL.List.prototype=Object.create(UIL.Proto.prototype);UIL.List.prototype.constructor=UIL.List;UIL.List.prototype.text=function(a){this.c[5].textContent=a};
UIL.List.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.setSvg(3,"width",this.sb);this.setDom(3,"width",this.sb);this.setDom(3,"left",this.sa);this.setDom(4,"left",this.sa+this.sb-17);this.setDom(5,"left",this.sa);this.setDom(5,"width",this.sb);this.setDom(2,"left",this.sa-20);this.setDom(2,"width",this.sb);this.setDom(6,"left",this.sa);this.setDom(6,"width",this.sb);this.setSvg(6,"x",this.sb-15);this.w=this.sb;this.max>this.maxHeight&&(this.w=this.sb-20);for(var a=0;a<this.length;a++)UIL.setDOM(this.listIn.children[a],
"width",this.w)};UIL.Bool=function(a){UIL.Proto.call(this,a);this.value=a.value||!1;this.c[2]=UIL.DOM("UIL svgbox","rect","width:17px;",{width:17,height:17,fill:UIL.SVGB,"stroke-width":1,stroke:UIL.SVGC});this.c[3]=UIL.DOM("UIL svgbox","path","width:17px; pointer-events:none;",{width:17,height:17,d:"M 4 9 L 6 12 14 4","stroke-width":2,stroke:"#e2e2e2",fill:"none","stroke-linecap":"butt"});this.value||(this.c[3].style.display="none");this.f[0]=function(a){this.value?(this.value=!1,this.c[3].style.display="none",UIL.setSVG(this.c[2],
"fill","rgba(0,0,0,0.2)")):(this.value=!0,this.c[3].style.display="block",UIL.setSVG(this.c[2],"fill","rgba(0,0,0,0.4)"));this.callback(this.value)}.bind(this);this.c[2].onclick=this.f[0];this.init()};UIL.Bool.prototype=Object.create(UIL.Proto.prototype);UIL.Bool.prototype.constructor=UIL.Bool;UIL.Bool.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.setDom(2,"left",this.sa);this.setDom(3,"left",this.sa)};UIL.Button=function(a){UIL.Proto.call(this,a);this.value=a.value||!1;this.c[2]=UIL.DOM("UIL svgbox","rect","",{width:this.sb,height:17,fill:UIL.bgcolor(UIL.COLOR),"stroke-width":1,stroke:UIL.SVGC});this.c[3]=UIL.DOM("UIL text","div","text-align:center;");this.c[1].textContent="";this.c[3].innerHTML=this.txt;this.f[0]=function(a){this.callback(this.value)}.bind(this);this.f[1]=function(a){this.c[3].style.color="#FFF";this.setSvg(2,"fill",UIL.SELECT)}.bind(this);this.f[2]=function(a){this.c[3].style.color=
"#CCC";this.setSvg(2,"fill",UIL.bgcolor(UIL.COLOR))}.bind(this);this.f[3]=function(a){this.c[3].style.color="#CCC";this.setSvg(2,"fill",UIL.SELECTDOWN)}.bind(this);this.c[2].onmousedown=this.f[3];this.c[2].onmouseover=this.f[1];this.c[2].onmouseout=this.f[2];this.c[2].onmouseup=this.f[1];this.c[2].onclick=this.f[0];this.init()};UIL.Button.prototype=Object.create(UIL.Proto.prototype);UIL.Button.prototype.constructor=UIL.Button;UIL.Button.prototype.label=function(a){this.c[3].textContent=a};
UIL.Button.prototype.icon=function(a){this.c[3].style.padding="0px 0px";this.c[3].innerHTML=a};UIL.Button.prototype.rSize=function(){UIL.Proto.prototype.rSize.call(this);this.setSvg(2,"width",this.sb,0);this.setDom(2,"width",this.sb);this.setDom(2,"left",this.sa);this.setDom(3,"width",this.sb);this.setDom(3,"left",this.sa)};
